// console.log("hello")
// let name1 = prompt("Name")
// let num2 = prompt("0-100?")
// let num3 = +prompt("0-100?")
// 
// let num1 = 20
// let num2 = 15
// 
// if(num1 % 2 == 0) {
    // alert("Четное")
// } else {
    // alert("нечетное")
// }
// 
// num1 % 2 ? alert("Больше") : alert("Меньше")

// function sum(a, b) {
    // console.log(a + b)
// }
// 
// sum(10, 5)
// sum(50, 10)
// sum(50, 5)
// 
// function minus(a,  b) {
    // console.log(a - b)
// }
// minus(20, 10)

// function name1(name) {
    // alert("Привет, " + name)
    // alert()
// }
// name1("Khalid")

// function ch(num) {
    // num % 2 console.log("нечетное") : console.log("четное")
// }
// ch(5)
// ch(10)

// year(1058)
// year(2022)
// function century(year) {
    // let result
    // result = Math.floor(year / 100 ) + 1
    // return result
// }
    // console.log(century(1900))

// let nambers = [10, 15, 40, 7]
// let arr = [10, "ten", "hello", true, [10, 15, 40, 7]]
// 
// console.log(nambers[2])
// console.log(arr[4][3])
// console.log(nambers)
// console.log(nambers.reverse())
// console.log(nambers)
// 
// console.log(nambers.length)
// function square(num) {
    // let result
    // result = num * num
    // return result
// }
// alert(square(3))
// function avg(num1, num2, num3) {
    // let result
    // result = (num1 + num2 + num3) / 3
    // return result
// 
// }
// console.log(avg(95, 85, 80))

// let nambers = [1, 2, 3, 4, 5]
// let newNabers = []
// for(let i = 0; i < nambers.length; i++) {
    // console.log(nambers[i] + 1)
    // newNabers.push(nambers[i] + 1)
// }
    // console.log(newNabers)
// let num = 0
// for(let i = 0; i < 50; i++) {
    // num = num + 2
    // console.log(num)
// }
// for(let i = 0; i < 100; i++) {
    // if (i % 2 == 0) {
        // console.log(i)
        // 
    // }
// }
// num = num + 15

// let arr = ["a", "a", "a"]
// console.log(arr)
// arr.push("anew")
// console.log(arr)
// arr.unshift("newa")
// console.log(arr)
// let name = arr.pop()
// arr.shift()
// let arr = ["камень", "ножницы", "бумага"]

// console.log(arr[Math.floor(Math.random() * 3)])

// function game() {
    // return arr[Math.floor(Math.random() * 3)]
// }
// console.log(game())
// function geerting(name) {
    // return `Hello, ${name}`
// }
// 
// console.log(geerting("Arsen"))
// let arr = [1, 3, 6, 10, 24, 5]
// function filterOdd(arr) {
    // let result = []
    // for (let i = 0; i < arr.length; i++) {
        // if (arr[i] % 2 == 1) {
            // result.push(arr[i])
        // }
    // }
    // return result
// }
// console.log(filterOdd(arr))

// function water(hours) {
    // let liters
    // liters = Math.floor(hours * 0.5)
        // return liters
    // }
// console.log(water(2.5))

// function past(h, m, s) {
    // let ms
    // ms = past (h * 3600000) + (m * 60000) + (s * 1000)
    // for (let i = 0; i < arr.length; i++) {
        // if (arr[i] / 12) {
            // ms.push(arr[i])
        // }
        // 
    // }
    // return ms
// }
// 
// console.log(past(0, 1, 1))
// let rgb1 = prompt("Text")
// let rgb2 = prompt("Text")
// let rgb3 = prompt("Text")
// 
// 
// function color(rgb) {
    // for (let i = 0; i < rgb1, rgb2, rgb3.length; i++) {
        // if (rgb1, rgb2, rgb3[i]) {
            //   
    // switch (rgb) {
        // case "0" :
            // return "ноль" ;
        // case "1" :
            // return "один" ;
        // case "2" :
            // return "два"  ;
        // case "3" :
            // return "три"  ;
        // case "4" :
            // return "четыре"  ;
        // case "5" :
            // return "пять"  ;
        // case "6" :
            // return "шесть"  ;
        // case "7" :
            // return "семь"  ;
        // case "8" :
            // return "восемь"  ;
        // case "9" :
            // return "девять"  
    // }}}
    // return rgb
// }
    // alert(color(rgb1, rgb2, rgb3))
// function num(nambers) {
    // 
// }
// function booleanToString(b) {
// }
// alert(b)
// let num1 = +prompt("Text")
// let num2 = +prompt("Text")
// let num3 = +prompt("Text")
// 
// let max = (a, b, c) => Math.max(a, b, c)
// alert(max(num1, num2, num3))
// let main = document.querySelector("main")
// 
// function renderDivs() {
    // for (let i = 0; i < 40; i++) {
        // let randomNum1 = Math.floor(Math.random() * 256)
        // let randomNum2 = Math.floor(Math.random() * 256)
        // let randomNum3 = Math.floor(Math.random() * 256)
        // let randomColor = `rgb(${randomNum1}, ${randomNum2}, ${randomNum3})`
        // main.innerHTML += `<div class='item' style='background-color: ${randomColor}'></div>`
    // 
    // }
// }
// renderDivs()
// let user = {
    // name : "Arsen",
    // img : "",
// }
// const main = document.querySelector('main')
// const renderUserCard = (userinfo) => {
    // main.innerHTML = `<div class='user'>
                            // <img scr='https://cdn-icons-png.flaticon.com/512/1946/1946429.png'.
                            // <div class='user-info'>
                                // <p class='username'>${userinfo}</p>
                            // </div>
                        // </div>`
// }

// {<div class="user">
    {/* <img src="https://cdn-icons-png.flaticon.com/512/1946/1946429.png" alt=""> */}
{/* <div class="userinfo">  */}
    {/* <p class="username">Arsen</p> */}
    {/* <p class="age">24</p> */}
    {/* <p class="hobbies">Hobbies</p> */}
    {/* <p class="technologes">Front</p> */}
{/* </div>  */}
{/* </div>} */}

const URL = 'http://localhost:3000/posts'
const main = document.querySelector('main')

fetch(URL)
    .then((response) => response.json())
    .then((data) => renderPosts(data))

const renderPosts = (posts) => {
    main.innerHTML = ''
    posts.map(post => {
        main.innerHTML += `
            <div class="posts posts${post.id}">
                <div class="active normalMode">
                    <h1>${post.title}</h1>
                    <img src="${post.img}">
                    <h4>${post.descr}</h4>
                    <button class="btn btn-danger" id="${post.id}">Удалить</button>
                    <button class="btn btn-edit btn-success" id="${post.id}">Редактировать</button>
                </div>
                <div class="editMode">
                    <input class="form-control new-title" type="text" name="new-titel" value="${post.title}">
                    <input class="form-control new-descr" type="text" name="new-descr" value="${post.descr}">
                    <input class="form-control new-img" type="text" name="new-img" value="${post.img}">
                    <button class="btn btn-save btn-success" id="${post.id}">Сохранить</button>
                </div>
            </div>        
        `
    })
}

window.addEventListener("click", (e) => {
    if(e.target.classList[1] == "btn-danger") {
        const id = e.target.id
        deletPost(id)
    }
    if(e.target.classList[1] == 'btn-edit') {
        const id = e.target.id
        togglePostMode(id)  
    }
})

document.addEventListener("click", (e) => {
    if(e.target.classList[1] == "btn-save") {
        const id = e.target.id
        const newTitle = document.querySelector(`.posts${id} .new-title`).value
        const newDescr = document.querySelector(`.posts${id} .new-descr`).value
        const newImg = document.querySelector(`.posts${id} .new-img`).value
        const newData = {
            title : newTitle,
            descr : newDescr,
            img : newImg
        }
        editPost(id, newData)
    }
})

const deletPost = (id) => {
    const urlDelete = `http://localhost:3000/posts/${id}`
    fetch(urlDelete, {
        method : 'DELETE',
        headers : {
            'Content-Type' : 'application/json',
        }
    })
}

const editPost = (id, newData) => {
    const urlEdit = `http://localhost:3000/posts/${id}`
    fetch(urlEdit, {
        method : 'PATCH',
        headers : {
                'Content-Type' : 'application/json',
            },
        body : JSON.stringify(newData)
    })
    .then(res => {
        togglePostMode(id)
        return res.json()
    })
    .then(data => {
        // console.log(data)
        chenchData(id,data)
    })
    .catch(err => console.log(err))
}

const chenchData = (id, data) => {
    const postWrapper = document.querySelector(`.posts${id}`)
    postWrapper.querySelector('h1').innerText = data.title
    postWrapper.querySelector('h4').innerText = data.descr
    postWrapper.querySelector('img').src = data.img
}

const togglePostMode = (id) => {
    const postWrapper = document.querySelector(`.posts${id}`)
    const normalMode = postWrapper.querySelector('.normalMode')
    const editMode = postWrapper.querySelector('.editMode')
    editMode.classList.toggle("active")
    normalMode.classList.toggle("active")
}

const category = 'http://localhost:3000/categories'
const categor = document.querySelector('.categories')

fetch(category)
    .then(res => res.json())
    .then(data => renderCategories(data))

const renderCategories = (categories) => {
    categories.map(category => {
        categor.innerHTML += `
            <a id="${category.id}" class="category">${category.name}</a>
            `   
    })
}

document.addEventListener('click', (e) => {
    if(e.target.classList[0] == "category") {
        const id = e.target.id
        console.log(e);
        fetchPostsByCategory(id)
    }
})

const fetchPostsByCategory = (categoryId) =>{
    fetch(`http://localhost:3000/posts?category=${categoryId}`)
    .then(res => res.json())
    .then(data => renderPosts(data))
}

// const newstr = str.replace(/[aeiou]/gi, '!')
// console.log(newstr)
// document.addEventListener("DOMContentLoaded", hiddenCloseclick());
//   document.getElementById('click-to-hide').addEventListener("click", hiddenCloseclick);
	// function hiddenCloseclick() {
	// let x = document.getElementById('hidden-element');
    //   if (x.style.display == "none"){
	//   x.style.display = "block";
	//   } else {
	//  x.style.display = "none"}
    // };
// const button = document.querySelector("#3")
// fetch(URL)
    // .then((posts) => posts.json())
    // .then((data) => renderUserName(data))
// 
// const renderUserName = (peacs) => {
    // peacs.filter(user => user.status == 'Alive').map(user => {
    // main.innerHTML += `<div class="user">
                        // <h1>${user.name}</h1>
                        // <div class="${user.status == "dead" ? "red" : "green"}radius"></div>
                        // <p class="s">${user.status}</p>
                        // <p class="g">${user.gender}</p>
                        // <img src='${user.image}'>
                        // <a href="${user.location.url}">${user.location.name}
                    //  </div>`
    // })
// }
// 
// const arr = [10, 20, 30, 40, 50]
// 
// let arr1 = arr.filter(num => num > 5 && num < 25).map(num => num + 10)
// 
// console.log(arr1)
// const postBtn = document.querySelector(".add-post")
// postBtn.addEventListener("click", () => {
// const post = {
    // title : "Peac-Tatyrcul",
    // descr : "Пик Тандыкул (Танды Кёль , Русский : Тандыкуль) - гора в Алайских горах Средней Азии . Тандыкуль находится на высоте 5 544 метра (18 189 футов) и находится на международной границе между Кыргызстаном и Таджикистаном",
    // img : "./img/img3.jpg"
// }
// fetch(URL, {
    // headers : {
        // 'Content-Type' : 'application/json'
    // },
    // method : 'POST',
    // body : JSON.stringify(post)
    // })
// })
// 